---
  title: "Money Problems and Mental Health"
author: "Adham Artimi (2676721), Daniel Mohammadpour (2749227), Nikki Borgen (2853132), Jip Allessie (2786323), Student 5 (0123456), Student 6 (0123456), Student 7 (0123456)"
date: "`r Sys.Date()`"
output: pdf_document
---
  
  # Set-up your environment
  
 ```{r package_install, include=FALSE}
install.packages("tidyverse")
install.packages("yaml")
install.packages("rmarkdown")
install.packages("lubridate")
```

```{r packages}
require(tidyverse)
require(rmarkdown)
require(yaml)
require(lubridate)
```

# Money Problems and Mental Health

Adham Artimi (2676721), Daniel Mohammadpour (2749227), Nikki Borgen (2853132), Jip Allessie (2786323), Student 5 (0123456), Student 6 (0123456), Student 7 (0123456)

Tutorial 3

Chantal Schouwenaar

# Part 1 - Identify a Social Problem

The relationship between income and mental health represents a significant social issue with consequences for individuals, families, and communities. People facing financial difficulties are more likely to experience mental health problems, while mental health issues can in turn reduce a person’s ability to work or maintain income stability. This creates a reinforcing cycle of disadvantage (World Health Organization, 2025).

Research has shown that individuals with lower incomes tend to suffer more from psychological stress, have less access to mental health services, and face living conditions that increase the risk of mental illness. Michael Marmot (2005) highlights how reduced control, limited resources, and chronic stress contribute to health inequalities among socioeconomically disadvantaged groups. Similarly, Pickett and Wilkinson (2001) found that mental health problems are more common in low-income communities due to factors like social isolation and resource scarcity.

Although this connection is well documented at the national and international levels, it remains unclear how income and mental health interact within cities. In this project, we investigate the extent to which these patterns appear across neighborhoods in Amsterdam, using local statistics and basic data analysis in R.

## 1.1 Describe the Social Problem

This issue is relevant because it highlights how economic inequality can lead to unequal mental health outcomes within the same city. If poorer neighborhoods in Amsterdam consistently show higher levels of mental health problems, this may reflect deeper structural inequalities in the distribution of public health resources and economic opportunity. Understanding these local patterns allows policymakers to target interventions more effectively, especially in the areas most in need (Thomson et al., 2023).

By analyzing neighborhood-level data from Amsterdam and applying simple coding techniques in RStudio, this project contributes to a better understanding of how income and mental health are related in an urban setting. Our findings may help support future decisions about healthcare access, social support, and economic policy.

# Part 2 - Data Sourcing

## 2.1 Load in the data

The data for this project was downloaded from the [RIVM StatLine](https://statline.rivm.nl), a public health platform that provides neighborhood-level statistics across the Netherlands.

We use two sets of data, zooming in specifically on the city of Amsterdam:
  - **Moeite met rondkomen (Trouble making ends meet)**  
  - **Hoog risico op angst of depressie (High risk of anxiety or depression)**
  
Additionally, we use a combined dataset that includes both the 'moeite met rondkomen' (difficulty making ends meet) and 'Hoog risico op angst of depressie' (High risk of anxiety or depression) variables. This combined dataset was exported for four reference years (2012, 2016, 2020, and 2022) and split into three age categories: 18 years and older, 18 to 65 years, and 65 years and older. This results in a total of 12 data files. All files were manually downloaded and loaded locally from the shared group folder, in line with the assignment instructions.

```{r loading_data}

# Set working directory (adjust this path if needed for your setup)
setwd("")
#############Nog aanpassen -> Krijg het niet aan de praat. #Adham

# Load the two datasets
rondkomen2012_18_of_ouder <- read.csv("Gezondheid_per_wijk_en_buurt__2012_18_of_ouder.csv")
rondkomen2016_18_of_ouder <- read.csv("Gezondheid_per_wijk_en_buurt__2016_18_of_ouder.csv")
rondkomen2020_18_of_ouder <- read.csv("Gezondheid_per_wijk_en_buurt__2020_18_of_ouder.csv")
rondkomen2022_18_of_ouder <- read.csv("Gezondheid_per_wijk_en_buurt__2022_18_of_ouder.csv")
rondkomen2012_18_tot_65 <- read.csv("Gezondheid_per_wijk_en_buurt__2012_18_tot_65.csv")
rondkomen2016_18_tot_65 <- read.csv("Gezondheid_per_wijk_en_buurt__2016_18_tot_65.csv")
rondkomen2020_18_tot_65 <- read.csv("Gezondheid_per_wijk_en_buurt__2020_18_tot_65.csv")
rondkomen2022_18_tot_65 <- read.csv("Gezondheid_per_wijk_en_buurt__2022_18_tot_65.csv")
rondkomen2012_65_of_ouder <- read.csv("Gezondheid_per_wijk_en_buurt__2012_65_of_ouder.csv")
rondkomen2016_65_of_ouder <- read.csv("Gezondheid_per_wijk_en_buurt__2016_65_of_ouder.csv")
rondkomen2020_65_of_ouder <- read.csv("Gezondheid_per_wijk_en_buurt__2020_65_of_ouder.csv")
rondkomen2022_65_of_ouder <- read.csv("Gezondheid_per_wijk_en_buurt__2022_65_of_ouder.csv")
```

## 2.2 Provide a short summary of the dataset(s)

We use datasets from the RIVM StatLine (Rijksinstituut voor Volksgezondheid en Milieu), which provide neighborhood-level statistics related to health and socioeconomic well-being in the Netherlands. Since all 12 datasets we use are identical in the number of observations and variables—differing only by year & age group—we provide a short summary of one representative dataset.

```{r summary dataset(s)}
# Let's have a quick glance of the dataset using the glimpse function (via dplyr)
glimpse(Gezondheid_per_wijk_en_buurt__2012_18_of_ouder)

####Eventueel nog een of max max twee summary functions #Adham

```

We will clean and merge the datasets in Section 3.1 to enable joint analysis

## 2.3 Describe the type of variables included ###################NOG DOEN

The variables in our dataset represent both **health-related** and **socioeconomic** indicators:
  
- The *Moeite met Rondkomen* dataset captures **socioeconomic status (SES)** by indicating the percentage of people who experience financial difficulty.
- The *Psychische Klachten* dataset captures **mental health status** through the percentage of people who report psychological complaints.

All variables are expressed as **percentages (%)** of individuals within defined age groups (`18+`, `18–65`, `65+`) at the neighborhood level.

According to the metadata provided on https://buurtatlas.vzinfo.nl, the data is collected via **national surveys** and **modeled estimates** at the municipal and neighborhood levels. This suggests a combination of self-reported survey results and statistical estimation techniques, rather than purely administrative records.

These indicators allow us to examine the intersection between financial stress and mental health across different neighborhoods in Amsterdam.

# Part 3 - Quantifying

## 3.1 Data cleaning

We cleaned each dataset by removing rows with missing area names or aggregate totals ("Nederland", "Gemeente: Amsterdam"). We then renamed columns to be more interpretable.

###Remove missing and aggregate rows

```{data_cleaning_step1: merge all the separate datasets}
amsterdam_gezondheid_merged <- rbind(Gezondheid_per_wijk_en_buurt__2012_18_of_ouder, Gezondheid_per_wijk_en_buurt__2012_18_tot_65, Gezondheid_per_wijk_en_buurt__2012_65_of_ouder, Gezondheid_per_wijk_en_buurt__2016_18_of_ouder, Gezondheid_per_wijk_en_buurt__2016_18_tot_65, Gezondheid_per_wijk_en_buurt__2016_65_of_ouder, Gezondheid_per_wijk_en_buurt__2020_18_of_ouder, Gezondheid_per_wijk_en_buurt__2020_18_tot_65, Gezondheid_per_wijk_en_buurt__2020_65_of_ouder, Gezondheid_per_wijk_en_buurt__2022_18_of_ouder, Gezondheid_per_wijk_en_buurt__2022_18_tot_65, Gezondheid_per_wijk_en_buurt__2022_65_of_ouder)
```

```{r data_cleaning_step2: Filter out the unnecessary columns "Marges" & "Regioaanduiding.Gemeentenaam..naam."}

amsterdam_gezondheid_clean <- amsterdam_gezondheid_merged |>
  select(-Marges) |>
  select(-Regioaanduiding.Gemeentenaam..naam.) 

```

```{r data_cleaning_step3: Filter out the rows with "Amsterdam"}
amsterdam_gezondheid <- amsterdam_gezondheid_clean |>
  filter(Wijken.en.buurten != "Amsterdam")

```

```{r data_cleaning_step4: rename for clarity}

amsterdam_gezondheid  <- amsterdam_gezondheid |>
  rename(
     wijken_en_buurten = Wijken.en.buurten,
    Type_regio = Regioaanduiding.Soort.regio..omschrijving.,
    regio_code = Regioaanduiding.Codering..code.,
    risico_depressie = Hoog.risico.op.angst.of.depressie....,
    moeite_met_rondkomen = Moeite.met.rondkomen....
  )

```

```{r data_cleaning_step5: set variables as numeric} 

amsterdam_gezondheid$risico_depressie = as.numeric(amsterdam_gezondheid$risico_depressie, na.rm = TRUE)

amsterdam_gezondheid$moeite_met_rondkomen = as.numeric(amsterdam_gezondheid$moeite_met_rondkomen, na.rm = TRUE)

```

```{r data_cleaning_step6: set periode as year} 

amsterdam_gezondheid$Perioden = ymd(amsterdam_gezondheid$Perioden, truncated = 2L)

```


## 3.2 Generate necessary variables

Variable 1

```{r gen_var1: Averages}

amsterdam_gezondheid <- amsterdam_gezondheid |>
  group_by(Perioden, Leeftijd) |>
  mutate(
    avg_risico_depressie = mean(risico_depressie, na.rm = TRUE),
    avg_moeite_rondkomen = mean(moeite_met_rondkomen, na.rm = TRUE)
  )

```

Variable 2

```{r gen_var2}

```

## 3.3 Visualize temporal variation

```{r visualise_map}

ggplot(amsterdam_gezondheid, aes(x = Perioden)) +
  geom_line(aes(y = avg_risico_depressie, color = "Depressie"), size = 1) +
  geom_line(aes(y = avg_moeite_rondkomen, color = "Rondkomen"), size = 1) +
  facet_wrap(~Leeftijd) +
  labs(title = "Ontwikkeling per leeftijdsgroep", x = "Jaar", y = "Gemiddelde score", color = "Variabele") +
  theme_minimal() +
  theme(axis.text.x = element_text(size = 6))

```

## 3.4 Visualize spatial variation

```{r visualise_map}

```

Here you provide a description of why the plot above is relevant to your specific social problem.

## 3.5 Visualize sub-population variation

What is the poverty rate by state?

```{r visualise_subpopulations}

ggplot(amsterdam_gezondheid, aes(x = Perioden, , y = risico_depressie, fill = Leeftijd)) +
  geom_boxplot(aes(x = Perioden, y = risico_depressie, fill = Leeftijd))

#df2 <- amsterdam_gezondheid |>
#  pivot_longer(cols = c("risico_depressie", "moeite_met_rondkomen"), names_to = "Variabele", values_to = "waarden")

#ggplot(df2, aes(x = as.numeric(Perioden), , y = waarden, fill = Variabele)) +
#  geom_boxplot(aes(x = as.numeric(Perioden), y = waarden, fill = Variabele))

```

Here you provide a description of why the plot above is relevant to your specific social problem.

## 3.6 Event analysis

Analyze the relationship between two variables.

```{r analysis}

ggplot(amsterdam_gezondheid, aes(x = Perioden)) +
  geom_line(aes(y = avg_risico_depressie,  color = "Depressie"), size = 1,) +
  geom_line(aes(y = avg_moeite_rondkomen, color = "Rondkomen"), size = 1) +
  geom_vline(aes(xintercept = as.Date("2020-03-01"), colour = "COVID-19"), linetype = "dashed") +
  labs(title = "Event studie 'COVID-19 2020'", x = "Jaar", y = "Gemiddelde score", color = "Variabele") +
  theme_minimal() +
  theme(axis.text.x = element_text(size = 6)) +
  scale_color_manual(name = "Variabele",
                     values = c("Depressie" = "Darksalmon", "Rondkomen" = "Darkcyan", "COVID-19" = "Black"))

# https://www.rijksoverheid.nl/onderwerpen/coronavirus-tijdlijn/maart-2020-maatregelen-tegen-verspreiding-coronavirus
```

Here you provide a description of why the plot above is relevant to your specific social problem.

# Part 4 - Discussion

## 4.1 Discuss your findings

# Part 5 - Reproducibility

## 5.1 Github repository link

Provide the link to your PUBLIC repository here: ...

## 5.2 Reference list

Use APA referencing throughout your document.